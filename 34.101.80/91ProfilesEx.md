# <a name="ProfilesEx"></a>Приложение A (рекомендуемое). Расширенные профили

## A.1 <a name="ProfilesEx1"></a>Общие положения

В настоящем приложении определяются 8 расширенных профилей РЭЦП: E-BES, E-EPES,
E-T, E-C, E-A, E-X, E-X-L, E-X-Long. Профили E-X, E-X-L и E-A могут быть двух
типов.

Профили разбиваются на две группы: профили, не допускающие ссылки на аттестаты
проверки (E-BES, E-EPES, E-T и E-A типа 1), и профили, допускающие ссылки (E-C,
E-X, E-X-L, E-X-Long, E-A типа 2). Профили первой группы являются уточнениями
базовых профилей, однако не расширяют их какими-либо атрибутами. Профили второй
группы позволяют уменьшить размер подписи за счет замены аттестатов проверки на
ссылки на эти аттестаты. Предусмотрены механизмы защиты ссылок.

Расширенные профили связаны друг с другом. Профиль E-EPES строится на основе
E-BES, E-T — на основе E-BES или E-EPES, E-C — на основе E-T, E-X и E-X-Long —
на основе E-C, E-X-L — на основе E-X. Профиль E-A может строиться двумя
различными способами: на основе E-T или на основе профилей, допускающих ссылки
на аттестаты проверки.

РЭЦП любого расширенного профиля формата XAdES разрешают включение атрибутов
двумя способами, описанными в разделе [10](10XADES.md) (прямое и непрямое
включения).

Процессы управления подписями профиля B-B переносятся на подписи профилей E-BES
и E-EPES.

Процессы управления подписями профилей B-T и B-LT переносятся на подписи
профилей E-T, E-C, E-X, E-X-L и E-X-Long.

Процессы управления подписями профиля B-LTA переносятся на подписи профилей E-A
(типов 1 и 2).

## A.2 <a name="ProfilesEx2"></a>Профили, не допускающие ссылки на аттестаты проверки

### A.2.1 <a name="ProfilesEx21"></a>Профили E-BES и E-EPES

Профили E-BES и E-EPES уточняют профиль B-B в следующих аспектах.

В РЭЦП профиля E-BES или E-EPES МОЖЕТ содержаться атрибут `SigningTime`.

В РЭЦП профиля E-BES НЕ РЕКОМЕНДУЕТСЯ включение атрибутов 
`SignaturePolicyStore` и `SignaturePolicyIdentifier`.

В РЭЦП профиля E-EPES, наоборот, ДОЛЖЕН быть включен атрибут
`SignaturePolicyIdentifier`. Включение атрибута `SignaturePolicyStore` возможно
только при условии, что атрибут `SignaturePolicyIdentifier` содержит
хэш-значение от документа регламента подписи.

Остальные требования остаются прежними.

### A.2.2 <a name="ProfilesEx22"></a>Профиль E-T

Профиль E-T является аналогом профиля B-T.

### A.2.3 <a name="ProfilesEx23"></a>Профиль E-A типа 1

Профиль E-A типа 1 является аналогом профиля B-LTA.

## A.3 <a name="ProfilesEx3"></a>Профили, допускающие ссылки на аттестаты проверки

### A.3.1 <a name="ProfilesEx31"></a>Профиль E-С

Дополнительно к атрибутам РЭЦП профиля E-T, РЭЦП данного профиля ДОЛЖНА 
содержать следующие атрибуты: 

- `CompleteCertificateReferences`;
- `CompleteRevocationReferences`.

Если в РЭЦП используются атрибутные сертификаты, то РЭЦП профиля E-С 
ДОЛЖНА содержать следующие атрибуты:

- `AttributeCertificateReferences`;
- `AttributeRevocationReferences`.

### A.3.2 <a name="ProfilesEx32"></a>Профиль E-X

Данный профиль позволяет включать в РЭЦП штамп времени только на ссылки 
(атрибут `RefsOnlyTimeStamp`) или на ссылки вместе с подписью (атрибут 
`SigAndRefsTimeStamp`). В зависимости от выбранного варианта различают два 
типа данного профиля. 

РЭЦП профиля E-X типа 1 ДОЛЖНА содержать атрибут `SigAndRefsTimeStamp`.

РЭЦП профиля E-X типа 2 ДОЛЖНА содержать атрибут `RefsOnlyTimeStamp`.

### A.3.3 <a name="ProfilesEx33"></a>Профиль E-X-Long

Профиль E-X-Long строится на профиле E-С путем добавления СОК и атрибутных 
сертификатов, а также аттестатов их отзыва. Следует избегать дублирования
сертификатов и аттестатов отзыва в пределах одной подписи. 

### A.3.4 <a name="ProfilesEx34"></a>Профиль E-X-L

Данный профиль является расширением профиля E-X и также может быть двух 
типов: профиль E-X-L типа 1 и профиль E-X-L типа 2. 

Профиль E-X-L типа 1 строится на профилях E-X типа 1 и E-X-Long путем 
включения в РЭЦП всех атрибутов, которые свойственны данными профилями. 

Профиль E-X-L типа 2 строится на профилях E-X типа 2 и E-X-Long путем 
включения в РЭЦП всех атрибутов, которые свойственны данными профилями. 

#### A.3.5 <a name="ProfilesEx35"></a>Профиль E-A типа 2

Данный профиль строится на основании всех вышеупомянутых профилей, 
допускающих ссылки на аттестаты проверки. Также РЭЦП данного профиля 
ДОЛЖНА содержать атрибут `ArchiveTimeStamp`. 

РЭЦП класса XAdES-E-A типа 2 ДОЛЖНА содержать атрибут `RenewedDigests`. 

